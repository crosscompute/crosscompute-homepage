{% extends 'base.html' %}

{% macro action_button(index) %}
{% set d = actions[index] %}
<a href="{{ d['asset_uri'] }}" class="button action">{{ d.name_text }}</a>
{% endmacro %}

{% macro link_list(items, class_text) %}
<ul{% if class_text %} class="{{ class_text }}"{% endif %}>
{% for d in items %}
{% set name_text = d['name_text'] %}
{% set description_html = d['description_html'] %}
{% set asset_uri = d['asset_uri'] %}
{% set video_uri = d['video_uri'] %}
<li><a href="{{ asset_uri }}">{{ name_text }}{% if name_text and description_html %}: {% endif %}{{ description_html | safe }}</a>{% if video_uri %} [<a href="{{ video_uri }}">video</a>]{% endif %}</li>
{% endfor %}
</ul>
{% endmacro %}

{% block head_html %}
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VP9T2V7B17"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'G-VP9T2V7B17');
</script>
<title>{{ title_text }}</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="{{ description_text }}">
<style>
header {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: space-between;
}
header > nav {
  display: flex;
  gap: 8px;
}
main {
  max-width: 640px;
  margin: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
main > img {
  width: 100%;
  margin-top: 16px;
}
footer {
  max-width: 640px;
  margin: auto;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.button {
  padding: 8px;
  border: 0;
  text-decoration: none;
  text-align: center;
}
.button:hover {
  cursor: pointer;
}
.action {
  font-size: large;
  background: #17A2F5;
  color: white;
  font-weight: bold;
  width: 100%;
}
#brand {
  height: 1.5em;
}
#acknowledgments > ul {
  list-style: none;
  padding: 0;
  display: none;
  gap: 8px;
  flex-wrap: wrap;
}
</style>
{% endblock %}

{% block header_html %}
<a href="{{ brand['asset_uri'] }}"><img id="brand" src="{{ brand['image_uri'] }}" loading="lazy"></a>
<nav>
<a href="#updates">Updates</a>
<a href="#requests">Requests</a>
<a href="https://crosscompute.net">Automations</a>
</nav>
{% endblock %}

{% block main_html %}
<section id="summary">
<h1>{{ headline_text }}</h1>
{{ pitch_html | safe }}
</section>

<img src="{{ assets[0].image_uri  }}" loading="lazy">

<section id="menu">
<h2>What We Do</h2>
{{ summary_html | safe }}
</section>

{{ action_button(0) }}

<section id="menu">
<h2>What We Offer</h2>
{{ menu_html | safe }}
</section>

{{ action_button(1) }}

<section id="showcase">
<h2>Browse Our Work</h2>
<h3 id="updates">Updates</h3>
{{ link_list(updates) }}
<h3 id="requests">Requests</h3>
{{ link_list(requests) }}
</section>

{{ action_button(2) }}

<section id="accomplishments">
<h2>Accomplishments</h2>
{{ link_list(accomplishments) }}
</section>
{% endblock %}

{% block footer_html %}
<section id="acknowledgments">
<h2><a href="#acknowledgments">Acknowledgments</a></h2>
{{ link_list(acknowledgments) }}
</section>

<section id="links">
<h2>Links</h2>
{{ link_list(links) }}
</section>

<section id="contact">
<h2>Contact</h2>
{{ link_list(contacts) }}
</section>

{{ action_button(3) }}
{% endblock %}

{% block body_js %}
document.querySelector('#acknowledgments h2 a').onclick = function() {
  this.parentNode.nextElementSibling.style.display = 'flex';
};
{% endblock %}
